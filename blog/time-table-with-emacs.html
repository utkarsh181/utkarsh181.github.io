<html>
  <head>
    <title>Time table with GNU Emacs</title>
    <link rel='stylesheet' type='text/css' href='../style.css'>
    </head>
    <body>
      <header>
	<a href="index.html">utkarsh181</a>
	<br>
	  <small>Home page</small>
	  <nav>
	    <a href="../blog">Blog</a>
	    <a href="../about.html">About</a>
	    <a href="../contact.html">Contact</a>
	  </nav>
	</header>
	<div id="content">
	  <h1 class="title">Time table with GNU Emacs</h1>
	  <div id="table-of-contents">
	    <h2>Table of Contents</h2>
	    <div id="text-table-of-contents">
	      <ul>
		<li><a href="#org62acfdd">Introduction</a></li>
		<li><a href="#orgbf44657">Convert Excel file to CSV</a></li>
		<li><a href="#org5f1e620">Clean up CSV files</a></li>
		<li><a href="#org186d841">CSV file to beautiful time-table</a></li>
	      </ul>
	    </div>
	  </div>

	  <div id="outline-container-org62acfdd" class="outline-2">
	    <h2 id="org62acfdd">Introduction</h2>
	    <div class="outline-text-2" id="text-1">
	      <p>
		It's not a very well kept secret that Emacs is an extensible editor
		and can be even extended to manage your university time table.  My
		university originally uses Excel files to distribute time tables which
		are pain to work with.  So I decided to use Emacs built-in table
		editor to interact with time table with added benefit of being plain
		text.
	      </p>
	    </div>
	  </div>

	  <div id="outline-container-orgbf44657" class="outline-2">
	    <h2 id="orgbf44657">Convert Excel file to CSV</h2>
	    <div class="outline-text-2" id="text-2">
	      <p>
		Excel files can be easily converted to CSV file from any application
		but I use Libreoffice to convert files to CSV.
	      </p>
	      <p>
		First open the Excel file in and new Libreoffice session
		and then by pressing <code>Ctrl-S</code> we are
		presented with following options, choose CSV extension
		and save the file.
	      <p>
		<img src="csv.png" title="Libreoffice save dialog">
		</p>
	      </div>
	      </div>

	      <div id="outline-container-org5f1e620" class="outline-2">
		<h2 id="org5f1e620">Clean up CSV files</h2>
		<div class="outline-text-2" id="text-3">
		  <p>
		    One of the major annoyance with previous time table was that it was
		    given to us without filtering classes from another batches which makes
		    it really long and difficult to parse.
		  </p>

		  <p>
		    So I wrote a simple Python script to parse the CSV file and filter out
		    necessary classes by taking command line arguments which you can get
		    from
		    <a href="https://github.com/utkarsh181/dotfiles/blob/master/bin/.local/bin/ttable">here</a>.
		  </p>

		  <div class="org-src-container">
		    <pre>$ ttable -h
usage: ttable [-h] -i INPUT -o OUTPUT -c CLASS_NAME

optional arguments:
-h, --help            show this help message and exit
-i INPUT, --input INPUT
                      input file
-o OUTPUT, --output OUTPUT
                      output file
-c CLASS_NAME, --class_name CLASS_NAME
		      class name</pre>
		  </div>

		  <p>
		    For example, if my current batch is <code>CS-41</code> and CSV file is
		    <code>time-table.csv</code> we can invoke the script as:
		  </p>

		  <div class="org-src-container">
		    <pre class="src src-sh">~ $ ttable -i time-table.csv -o output.csv -c cs41</pre>
		  </div>

		  <p>
		    This will produce <code>output.csv</code> as a cleaned-up CSV file.
		  </p>
		</div>
	      </div>

	      <div id="outline-container-org186d841" class="outline-2">
		<h2 id="org186d841">CSV file to beautiful time-table</h2>
		<div class="outline-text-2" id="text-4">
		  <p>
		    Open an empty <b>org-mode</b> file in Emacs and then invoke <code>M-x
		      org-table-import</code> and choose the output csv file.
		  </p>

		  <p>
		    Here is a sample screenshot of the resultant time-table:
		  </p>

		  <p>
		    <img src="time-table.png" title="Pretty time table">
		    </p>
		  </div>
		</div>
	      </div>
	      <div id="postamble" class="status">
		<p class="author">Author: Utkarsh Singh</p>
		<p class="date">Created: 2021-03-02 Tue 13:30</p>
	      </div>
	      <footer>
		Copyright(c)2021 Utkarsh Singh.  All original content is
		licensed under free/libre copyleft license(GPL or CC BY-SA).
	      </footer>
	    </body>
	  </html>
